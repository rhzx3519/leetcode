package main

import "fmt"

/**
https://leetcode-cn.com/problems/valid-sudoku/
 */

const N int = 9

func isValidSudoku(board [][]byte) bool {
	col := make([]int, N)
	cell := make([]int, N)

	for i := 0; i < N; i++ {
		var x int
		for j := 0; j < N; j++ {
			c := board[i][j]
			if c == '.' {
				continue
			}
			k := 1 << int(c - '1')

			if x & k != 0 {
				return false
			}
			if col[j] & k != 0 {
				return false
			}
			cx, cy := i/3, j/3
			cid := cx*3 + cy
			if cell[cid] & k != 0 {
				return false
			}

			cell[cid] |= k
			col[j] |= k
			x |= k
		}
	}
	return true
}

func main() {
	// true
	fmt.Println(isValidSudoku([][]byte{
		{'5','3','.','.','7','.','.','.','.'},
		{'6','.','.','1','9','5','.','.','.'},
		{'.','9','8','.','.','.','.','6','.'},
		{'8','.','.','.','6','.','.','.','3'},
		{'4','.','.','8','.','3','.','.','1'},
		{'7','.','.','.','2','.','.','.','6'},
		{'.','6','.','.','.','.','2','8','.'},
		{'.','.','.','4','1','9','.','.','5'},
		{'.','.','.','.','8','.','.','7','9'}}))

	// false
	fmt.Println(isValidSudoku([][]byte{
		{'8','3','.','.','7','.','.','.','.'},
		{'6','.','.','1','9','5','.','.','.'},
		{'.','9','8','.','.','.','.','6','.'},
		{'8','.','.','.','6','.','.','.','3'},
		{'4','.','.','8','.','3','.','.','1'},
		{'7','.','.','.','2','.','.','.','6'},
		{'.','6','.','.','.','.','2','8','.'},
		{'.','.','.','4','1','9','.','.','5'},
		{'.','.','.','.','8','.','.','7','9'}}))

	// false
	fmt.Println(isValidSudoku([][]byte{
		{'.','.','4','.','.','.','6','3','.'},
		{'.','.','.','.','.','.','.','.','.'},
		{'5','.','.','.','.','.','.','9','.'},
		{'.','.','.','5','6','.','.','.','.'},
		{'4','.','3','.','.','.','.','.','1'},
		{'.','.','.','7','.','.','.','.','.'},
		{'.','.','.','5','.','.','.','.','.'},
		{'.','.','.','.','.','.','.','.','.'},
		{'.','.','.','.','.','.','.','.','.'}}))
}
